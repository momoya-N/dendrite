\documentclass[autodetect-engine,dvi=dvipdfmx,a4paper,ja=standard,oneside,openany,11pt]{bxjsbook}
\usepackage{../../Preamble/mypackage}


\begin{document}
\appendix
\chapter{スケールフリー性を持つ関数がべき関数になることの証明}
\label{sec:scale_free}
スケールフリー関数$f(x)$はスケール$a$のみに依存する関数$g(a)$を用いて
\begin{equation}
  \frac{f(ax)}{f(x)}=g(a) \quad (a>0)
  \label{eq:scale_free}
\end{equation}
と表される。式\eqref{eq:scale_free}を両辺$a$で微分し変形する。連鎖律より，
\begin{equation}
  \frac{\d (ax)}{\d a}\frac{\d f(ax)}{\d (ax)}          =\frac{\d g(a)}{\d a}f(x)
\end{equation}
となる。$a$を1に近づけると
\begin{equation}
  x\frac{\d f(x)}{\d (x)}                 =D_f f(x)
\end{equation}
となる。ただし，
\begin{equation}
  D_f=\eval{\frac{\d g(a)}{\d a}}_{a=1}
\end{equation}
である。$x>0$かつ$f(x)>0$の範囲で，
\begin{equation}
  \frac{1}{f(x)}\frac{\d f(x)}{\d x}                    =\frac{D_f}{x}
\end{equation}
と変形できる。この式を$x_0$から$x$まで積分すると，
\begin{equation}
  \begin{split}
    \int_{x_0}^{x} \frac{1}{f(x)}\frac{\d f(x)}{\d x}\d x & =\int_{x_0}^{x} \frac{D_f}{x}\d x       \\
    \log f(x)-\log f(x_0)                                 & =D_f\log x-D_f\log x_0                  \\
    \log \frac{f(x)}{f(x_0)}                              & =D_f\log \frac{x}{x_0}                  \\
    f(x)                                                  & =f(x_0)\left(\frac{x}{x_0}\right)^{D_f}
  \end{split}
  \label{eq:scale_free_proof}
\end{equation}
式\eqref{eq:scale_free_proof}よりスケールフリー性を持つ関数は冪関数になることが示された。

% \chapter{Poisson-Boltzmann (PB) 方程式による電気二重層の厚さの導出}
% 一次元系におけるPB方程式は，
% \begin{equation}
%   \frac{d^2\psi}{dx^2} = -\frac{e}{\varepsilon}\sum_{i}n_{i\infty}z_i\exp\ab(-\frac{ez_i\psi}{k_BT})
%   \label{eq:PB_1D_appendix}
% \end{equation}

\chapter{Brown運動に関する理論計算}
\section{ランダムウォーク（RW）からの拡散方程式の導出}
\label{sec:RW_cal}
1ステップ後の粒子の濃度についての式
\begin{equation}
  c(\bm{x},t+\Delta t)=\sum_{i=1}^{d}\left[p_i(\bm{x}-a\bm{e}_i,t) c(\bm{x}-a\bm{e}_i,t)+q_i(\bm{x}+a\bm{e}_i,t) c(\bm{x}+a\bm{e}_i,t)\right]
  \label{eq:RW}
\end{equation}
を左辺は一次，右辺は二次までTaylor展開する。
\begin{equation}
  \begin{split}
    \mathrm{（左辺）} & =c(\bm{x},t)+\pdv{c(\bm{x},t)}{t}\Delta t+\mathcal{O}((\Delta t)^2)                                                                                                                                                                                    \\
    \mathrm{（右辺）} & =\sum_{i=1}^{d}\left[\left\{p_i(\bm{x},t)-a\pdv{p_i(\bm{x},t)}{x_i}+\frac{a^2}{2}\pdv[2]{p_i(\bm{x},t)}{x_i}+\mathcal{O}(a^3)\right\}\left\{c(\bm{x},t)-a\pdv{c(\bm{x},t)}{x_i}+\frac{a^2}{2}\pdv[2]{c(\bm{x},t)}{x_i}+\mathcal{O}(a^3)\right\}\right. \\
                  & \hspace{30pt}\left.+\left\{q_i(\bm{x},t)+a\pdv{q_i(\bm{x},t)}{x_i}+\frac{a^2}{2}\pdv[2]{q_i(\bm{x},t)}{x_i}+\mathcal{O}(a^3)\right\}\left\{c(\bm{x},t)+a\pdv{c(\bm{x},t)}{x_i}+\frac{a^2}{2}\pdv[2]{c(\bm{x},t)}{x_i}+\mathcal{O}(a^3)\right\}\right]  \\
                  & =\sum_{i=1}^{d}\left[\underset{=1/d}{\uwave{\left\{p_i(\bm{x},t)+q_i(\bm{x},t)\right\}}}c(\bm{x},t)-a\pdv*{\left\{p_i(\bm{x},t)-q_i(\bm{x},t)\right\}c(\bm{x},t)}{x_i}\right.                                                                          \\
                  & \hspace{250pt}\left.+\frac{a^2}{2}\pdv*[2]{\underset{=1/d}{\uwave{\left\{p_i(\bm{x},t)+q_i(\bm{x},t)\right\}}}c(\bm{x},t)}{x_i}\right] +\mathcal{O}(a^3)                                                                                               \\
                  & =c(\bm{x},t)+\sum_{i=1}^{d}\left[-a\pdv*{\left\{p_i(\bm{x},t)-q_i(\bm{x},t)\right\}c(\bm{x},t)}{x_i}+\frac{a^2}{2d}\pdv[2]{c(\bm{x},t)}{x_i}\right]+\mathcal{O}(a^3)
  \end{split}
  \label{eq:RW_taylor}
\end{equation}
よって，$\Delta t$の一次，$a$の二次まで取ると
\begin{equation}
  \pdv{c(\bm{x},t)}{t}=-\sum_{i=1}^{d}\left[\pdv*{\left\{p_i(\bm{x},t)-q_i(\bm{x},t)\right\}\frac{a}{\Delta t}c(\bm{x},t)}{x_i}\right]+\frac{a^2}{2d\Delta t}\sum_{i=1}^{d}\left[\pdv[2]{c(\bm{x},t)}{x_i}\right]
  \label{eq:RW_diffusion}
\end{equation}
が成り立つ。
\section{過減衰Langenvin方程式の分散の詳細な計算}
\label{sec:Langevin_cal}
運動方程式
\begin{equation}
  \odv{\bm{x}}{t}=\mu q\bm{E}+\mu\bm{\xi}(t)
  \label{eq:Langevin_overdamped}
\end{equation}
より，時刻$t$での位置$\bm{x}(t)$は0から$t$までの積分を行うと求められる。ただしランダム力$\bm{\xi}(t)$は\Red{イントロの過減衰Langevinと同じでdが入っているのはオカシイ？}
\begin{equation}
  \begin{split}
    \langle\xi_\alpha(t)\rangle              & =0                                                                       \\
    \langle\xi_\alpha(t)\xi_\beta(t')\rangle & =2d\gamma k_B T\delta_{\alpha\beta}\delta(t-t') \qquad (d:\mathrm{空間次元})
  \end{split}
  \label{eq:random_force}
\end{equation}
で与えられる関係式を満たす。時刻$t$での位置$\bm{x}(t)$は
\begin{equation}
  \bm{x}(t)=\bm{x}(0)+\mu q\bm{E}t+\mu\int_0^t\bm{\xi}(t')\d t'
  \label{eq:Langevin_overdamped_integrated}
\end{equation}
と表される。式\ref{eq:Langevin_overdamped_integrated}の両辺の二乗を取り，平均を取ると，式\eqref{eq:Langevin_overdamped_variance_appendix}のようになる。ただし，初期位置$\bm{x}(0)=\bm{0}$とした。
\begin{equation}
  \begin{split}
    \langle\bm{x}(t)^2\rangle & =(\mu q \bm{E} t)^2+2\mu^2 q t\ab\langle\int_{0}^{t}\bm{E}(\bm{x})\cdot\bm{\xi}(t') \d t'\rangle+\mu^2\ab\langle\int_{0}^{t}\int_{0}^{t}\bm{\xi}(t')\cdot
    \bm{\xi}(t'') \d t' \d t''\rangle                                                                                                                                                                                                                                 \\
                              & =(\mu q \bm{E} t)^2+2\mu^2 q t\ab\int_{0}^{t}\bm{E}(\bm{x})\cdot\underset{=\bm{0}}{\uwave{\langle\bm{\xi}(t')\rangle}} \d t'+\mu^2\ab\int_{0}^{t}\int_{0}^{t}\underset{=2d\gamma k_B T\delta(t'-t'')}{\uwave{\langle\bm{\xi}(t')\cdot
    \bm{\xi}(t'')\rangle}} \d t' \d t''                                                                                                                                                                                                                               \\
                              & =(\mu q \bm{E} t)^2+2d\mu k_B T t                                                                                                                                                                                                     \\
  \end{split}
  \label{eq:Langevin_overdamped_variance_appendix}
\end{equation}

\chapter{逐次加速緩和法(Successive Over Relaxation: SOR)の概要}
\label{sec:SOR}
\textbf{SOR法}はPoisson方程式の数値解法である\textbf{Gauss-Seidel法}を改良したものである。まず，Poisson方程式
\begin{equation}
  \nabla^2\phi(\bm{x})=-\rho(\bm{x})
  \label{eq:poisson}
\end{equation}
を数値的に解くために，離散化した方程式を考える。ここで，$\bm{x}=(x,y)$は二次元空間内の位置ベクトル，$\phi(\bm{x})$はポテンシャル，$\rho(\bm{x})$は適当な関数である。二次元空間を格子点で離散化する。格子点$(i,j)$におけるLaplacianは，格子間隔$\Delta x=\Delta y=h$とすると
\begin{equation}
  \left\{
  \begin{aligned}
    \phi_{i\pm1,j} & =\phi_{i,j}\pm \pdv{\phi}{x}h+\pdv[2]{\phi}{x}\frac{h^2}{2}+\mathcal{O}(h^3) \\
    \phi_{i,j\pm1} & =\phi_{i,j}\pm \pdv{\phi}{y}h+\pdv[2]{\phi}{y}\frac{h^2}{2}+\mathcal{O}(h^3)
  \end{aligned}
  \right.
  \label{eq:discrete_laplasian}
\end{equation}
で与えられる。式\eqref{eq:discrete_laplasian}より，Laplacianは
\begin{equation}
  \begin{split}
    (\nabla^2\phi)_{i,j} & =\left\{\left(\pdv*[2]{}{x}+\pdv*[2]{}{y}\right)\phi\right\}_{i,j}                                            \\
                         & =\frac{1}{h^2}\left\{\phi_{i+1,j}+\phi_{i-1,j}+\phi_{i,j+1}+\phi_{i,j-1}-4\phi_{i,j}\right\}+\mathcal{O}(h^3) \\
                         & =-\rho_{i,j}
  \end{split}
  \label{eq:discrete_poisson}
\end{equation}
と離散化される。式\eqref{eq:discrete_poisson}を
\begin{equation}
  \phi_{i,j}^{n+1}=\frac{1}{4}\left(\phi_{i+1,j}^{n}+\phi_{i-1,j}^{n+1}+\phi_{i,j+1}^{n}+\phi_{i,j-1}^{n+1}+h^2\rho_{i,j}\right)
  \label{eq:Gauss-Seidel}
\end{equation}
のように更新して，前回ステップとの差が規定値以下になるまで計算していく。ここで$n$は計算ステップである。式\ref{eq:Gauss-Seidel}のようなLaplace方程式の計算方法は\textbf{Gauss-Seidel法}と呼ばれる。ここに加速パラメータ$r$を導入し
\begin{equation}
  \phi_{i,j}^{n+1}=(1-r)\phi_{i,j}^{n}+\frac{r}{4}\left(\phi_{i+1,j}^{n}+\phi_{i-1,j}^{n+1}+\phi_{i,j+1}^{n}+\phi_{i,j-1}^{n+1}+h^2\rho_{i,j}\right)
  \label{eq:SOR}
\end{equation}
のように更新式を変更する。式\ref{eq:SOR}の更新方法は\textbf{SOR法}と呼ばれる。SOR法はGauss-Seidel法よりも収束が速いことが知られている。実際，本研究での電場の計算にかかった実時間は，Gaiss-Seidel法に対しておおよそ1/10程度になっていた。

加速パラメータ$r$の値によって，効率が変化する。
\begin{itemize}
  \item $0<r<1$のとき，\textbf{under-relax}と呼ばれ，収束が遅くなる。
  \item $r=1$のとき，Gauss-Seidel法と等価である。
  \item $1<r<2$のとき，\textbf{over-relax}と呼ばれ，収束が早くなる。
  \item $2<r$のとき，収束しない。
\end{itemize}
十分大きな系のサイズ$N$に対して，最適な$r=r_{\mathrm{optimize}}$は,
\begin{equation}
  r_{\mathrm{optimize}}=\frac{2}{1+\pi/N}
  \label{eq:optimaze_r}
\end{equation}
で与えられる。$r=r_{\mathrm{optimize}}$の時，計算量はGauss-Seidel法が$\mathcal{O}(N^2)$なのに対して, SOR法は（厳密に）$2N$である。Gauss-Seidel法およびSOR法については文献\cite{hinch2020numerical}を参考にした。

\ifdraft{
  \bibliographystyle{../../Preamble/Physics.bst}
  \bibliography{../../Preamble/reference.bib}
}{}
\end{document}